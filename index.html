<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dérive - Tienda</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; margin:0; background:#000; color:#fff; }
    header { position:sticky; top:0; background:#000; padding:12px; z-index:1000; border-bottom:1px solid #111; text-align:center; }
    header img { max-height:70px; display:block; margin:0 auto; }
    nav { display:flex; justify-content:center; gap:20px; padding:10px; background:#000; }
    nav a { color:#fff; text-decoration:none; font-weight:700; cursor:pointer; }
    nav a:hover { text-decoration:underline; }

    main { max-width:1100px; margin:14px auto; padding:0 12px; }

    section { display:none; padding:18px 0; }
    section.active { display:block; }

    h2 { text-align:center; margin:0 0 14px 0; border-bottom:2px solid #222; padding-bottom:10px; }

    /* Carrusel inicio */
    .carousel { position:relative; max-width:600px; margin:16px auto; border-radius:10px; overflow:hidden; background:#0b0b0b; }
    .carousel img { width:100%; display:none; object-fit:cover; }
    .carousel img.active { display:block; }
    .carousel .btn { position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,0.6); color:#fff; border:0; padding:8px 10px; border-radius:999px; cursor:pointer; }
    .carousel .btn.prev { left:10px; }
    .carousel .btn.next { right:10px; }

    .socials { display:flex; gap:12px; justify-content:center; margin-top:12px; }
    .socials a { display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; background:#111; color:#fff; text-decoration:none; }
    .socials img { width:26px; height:26px; object-fit:contain; }

    /* Productos grid */
    .products { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:18px; }
    .product { background:#0f0f0f; padding:16px; border-radius:10px; text-align:center; }
    .mini-carousel { position:relative; height:200px; background:#080808; border-radius:8px; display:flex; align-items:center; justify-content:center; overflow:hidden; cursor:pointer; }
    .mini-carousel img { max-width:100%; max-height:190px; display:none; object-fit:contain; }
    .mini-carousel img.active { display:block; }
    .mini-carousel .btn { position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,0.6); color:#fff; border:0; padding:6px; border-radius:999px; cursor:pointer; }
    .mini-carousel .btn.prev { left:8px; }
    .mini-carousel .btn.next { right:8px; }

    .product h3 { margin:12px 0 6px 0; font-size:18px; cursor:pointer; }
    .product .price { font-weight:700; margin-bottom:8px; }
    .product select { width:100%; padding:10px; border-radius:6px; background:#111; color:#fff; border:1px solid #222; margin-bottom:8px; }
    .product .add-btn, .product .buy-btn { width:100%; padding:10px; border-radius:8px; border:0; font-weight:700; cursor:pointer; }
    .product .add-btn { background:#fff; color:#000; margin-bottom:8px; }
    .product .buy-btn { background:#2ecc71; color:#fff; }

    /* Carrito */
    .cart-wrap { max-width:900px; margin:0 auto; }
    .cart-list { list-style:none; padding:0; margin:0; }
    .cart-item { display:flex; justify-content:space-between; align-items:center; padding:10px; border-radius:8px; background:#0e0e0e; margin-bottom:8px; }
    .cart-item .meta { color:#aaa; font-size:14px; }
    .remove-btn { background:#c0392b; color:#fff; border:0; padding:8px 10px; border-radius:6px; cursor:pointer; }

    .checkout-wrap { text-align:center; margin-top:12px; }
    .checkout-btn { padding:10px 16px; border-radius:8px; border:0; background:#27ae60; color:#fff; cursor:pointer; font-weight:700; }

    /* ===== Modal Producto ===== */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    .modal-content {
      background:#111;
      padding:20px;
      border-radius:12px;
      max-width:800px;
      width:95%;
      max-height:90vh;
      overflow-y:auto;
    }
    .close-btn {
      float:right;
      font-size:28px;
      cursor:pointer;
      color:#fff;
    }
    .modal-body {
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:20px;
    }
    .modal-carousel { position:relative; }
    .modal-carousel img { width:100%; display:none; border-radius:10px; object-fit:contain; background:#000; }
    .modal-carousel img.active { display:block; }
    .modal-carousel .btn {
      position:absolute; top:50%; transform:translateY(-50%);
      background:rgba(0,0,0,0.6); color:#fff; border:0; padding:8px; border-radius:999px; cursor:pointer;
    }
    .modal-carousel .btn.prev { left:10px; }
    .modal-carousel .btn.next { right:10px; }
    @media(max-width:720px){
      .modal-body{ grid-template-columns:1fr; }
    }

    @media(max-width:640px){
      .mini-carousel{height:150px}
      .carousel{max-width:92%}
    }
  </style>
</head>
<body>
  <header>
    <img src="img/logo.png" alt="Logo" />
    <nav>
      <a onclick="showSection('inicio')">Inicio</a>
      <a onclick="showSection('productos')">Productos</a>
      <a onclick="showSection('carrito')">Carrito</a>
    </nav>
  </header>

  <main>
    <!-- INICIO -->
    <section id="inicio" class="active">
      <h2>Bienvenido a Dérive</h2>
      <div class="carousel" id="inicio-carousel">
        <img src="img/inicio1.jpg" class="active" alt="inicio1">
        <img src="img/inicio2.jpg" alt="inicio2">
        <img src="img/inicio3.jpg" alt="inicio3">
        <img src="img/inicio4.jpg" alt="inicio4">
        <img src="img/inicio5.jpg" alt="inicio5">
        <img src="img/inicio6.jpg" alt="inicio6">
        <img src="img/inicio7.jpg" alt="inicio7">
        <img src="img/inicio8.jpg" alt="inicio8">
        <img src="img/inicio9.jpg" alt="inicio9">
        <img src="img/inicio10.jpg" alt="inicio10">
        <img src="img/inicio11.jpg" alt="inicio11">
        <img src="img/inicio12.jpg" alt="inicio12">
        <img src="img/inicio13.jpg" alt="inicio13">
        <img src="img/inicio14.jpg" alt="inicio14">
        <button class="btn prev" onclick="moveSlide('inicio-carousel', -1)">❮</button>
        <button class="btn next" onclick="moveSlide('inicio-carousel', 1)">❯</button>
      </div>

      <div class="socials">
        <a href="https://www.instagram.com/derive_clothesz" target="_blank"><img src="img/instagram.png" alt="IG"> @derive_clothesz</a>
        <a href="https://www.tiktok.com/@derive_clothesz" target="_blank"><img src="img/tiktok.png" alt="TT"> @derive_clothesz</a>
      </div>
    </section>

    <!-- PRODUCTOS -->
    <section id="productos">
      <h2>Productos</h2>
      <div class="products" id="productsContainer">
        <!-- Cards generadas por JS -->
      </div>
    </section>

    <!-- CARRITO -->
    <section id="carrito">
      <h2>Carrito</h2>
      <div class="cart-wrap">
        <ul id="cartList" class="cart-list"></ul>
        <div class="checkout-wrap">
          <div id="cartTotal" style="margin-bottom:8px;color:#ccc"></div>
          <button class="checkout-btn" onclick="checkout()">Realizar pago (Culqi)</button>
        </div>
      </div>
    </section>
  </main>

  <!-- MODAL PRODUCTO -->
  <div id="productModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal()">&times;</span>
      <div class="modal-body">
        <div class="modal-carousel" id="modalCarousel"></div>
        <div class="modal-info">
          <h3 id="modalName"></h3>
          <div class="price" id="modalPrice"></div>
          <select id="modalSize">
            <option value="">Selecciona talla</option>
            <option value="s">S</option>
            <option value="m">M</option>
            <option value="l">L</option>
          </select>
          <button class="add-btn" onclick="modalAddToCart()">Añadir al carrito</button>
          <button class="buy-btn" onclick="modalBuyNow()">Comprar ahora</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* ====== Catálogo (precios + imágenes + links) ====== */
    const productCatalog = {
      drift: {
        name: 'Drift into Adventure',
        price: 54.90,
        images: ['img/drift1.jpg','img/drift2.jpg','img/drift3.jpg','img/drift4.jpg'],
        links: { s:'https://express.culqi.com/pago/4XR759TFKR', m:'https://express.culqi.com/pago/8TH3QXWLNK', l:'https://express.culqi.com/pago/OC166GW63C' }
      },
      true: {
        name: 'True style shirt',
        price: 54.90,
        images: ['img/true1.jpg','img/true2.jpg','img/true3.jpg','img/true4.jpg'],
        links: { s:'https://express.culqi.com/pago/QFPW93XY8O', m:'https://express.culqi.com/pago/EUG6FWG6G8', l:'https://express.culqi.com/pago/10BIBI0YXF' }
      },
      strive: {
        name: 'Strive for the future',
        price: 49.90,
        images: ['img/strive1.jpg','img/strive2.jpg','img/strive3.jpg'],
        links: { s:'https://express.culqi.com/pago/Z7WU1QZM5G', m:'https://express.culqi.com/pago/C8FFVNC1MY', l:'https://express.culqi.com/pago/AR0YFZMUX2' }
      },
      boundless: {
        name: 'Boundless style shirt',
        price: 54.90,
        images: ['img/boundless1.jpg','img/boundless2.jpg','img/boundless3.jpg','img/boundless4.jpg'],
        links: { s:'https://express.culqi.com/pago/F7E5CGA5JY', m:'https://express.culqi.com/pago/UUHHRQZSYM', l:'https://express.culqi.com/pago/HCFOKDYRCM' }
      },
      pisco: {
        name: 'Pisco sour',
        price: 59.90,
        images: ['img/pisco1.jpg','img/pisco2.jpg','img/pisco3.jpg','img/pisco4.jpg'],
        links: { s:'https://express.culqi.com/pago/QC4GCS9NIP', m:'https://express.culqi.com/pago/NKQT58SKAV', l:'https://express.culqi.com/pago/9SOBG18T5U' }
      }
    };

    /* ====== Estado del carrito (localStorage) ====== */
    let cart = JSON.parse(localStorage.getItem('derive_cart') || '[]');
    function saveCart(){ localStorage.setItem('derive_cart', JSON.stringify(cart)); }

    /* ====== Navegación entre secciones ====== */
    function showSection(id){
      document.querySelectorAll('main section').forEach(s => s.classList.remove('active'));
      const el = document.getElementById(id);
      if(el) el.classList.add('active');
      if(id === 'carrito') renderCart();
    }

    // Inicial
    document.addEventListener('DOMContentLoaded', () => {
      renderProducts();
      showSection('inicio');
      startAutoSlide();
      renderCart();
    });

    /* ====== Carrusel ====== */
    function moveSlide(carouselId, step){
      const container = document.getElementById(carouselId);
      if(!container) return;
      let slides = Array.from(container.querySelectorAll('.slide, img'));
      if(slides.length === 0) slides = Array.from(container.querySelectorAll('img'));
      if(slides.length === 0) return;
      let current = slides.findIndex(el => el.classList.contains('active'));
      if(current === -1) current = 0;
      slides[current].classList.remove('active');
      const nextIdx = (current + step + slides.length) % slides.length;
      slides[nextIdx].classList.add('active');
      if(carouselId === 'inicio-carousel') resetAutoSlide();
    }

    let autoSlideTimer;
    function startAutoSlide(){ autoSlideTimer = setInterval(()=> moveSlide('inicio-carousel', 1), 5000); }
    function resetAutoSlide(){ clearInterval(autoSlideTimer); startAutoSlide(); }

    /* ====== Render productos ====== */
    function renderProducts(){
      const container = document.getElementById('productsContainer');
      container.innerHTML = '';
      Object.keys(productCatalog).forEach(key => {
        const p = productCatalog[key];
        const card = document.createElement('div');
        card.className = 'product';
        const miniId = 'mini-' + key;
        const miniImgs = p.images.map((src,i)=>`<img src="${src}" class="${i===0?'active':''}" alt="${key}-${i}">`).join('');
        card.innerHTML = `
          <div class="mini-carousel" id="${miniId}" onclick="openModal('${key}')">
            ${miniImgs}
            <button class="btn prev" onclick="event.stopPropagation();moveSlide('${miniId}',-1)">❮</button>
            <button class="btn next" onclick="event.stopPropagation();moveSlide('${miniId}',1)">❯</button>
          </div>
          <h3 onclick="openModal('${key}')">${p.name}</h3>
          <div class="price">S/ ${p.price.toFixed(2)}</div>
          <select id="${key}-size">
            <option value="">Selecciona talla</option>
            <option value="s">S</option>
            <option value="m">M</option>
            <option value="l">L</option>
          </select>
          <button class="add-btn" onclick="addToCart('${key}')">Añadir al carrito</button>
          <button class="buy-btn" onclick="buyNow('${key}')">Comprar ahora</button>
        `;
        container.appendChild(card);
      });
    }

    /* ====== Carrito ====== */
    function addToCart(key){
      const select = document.getElementById(`${key}-size`);
      if(!select) { alert('Selector no encontrado'); return; }
      const size = select.value;
      if(!size){ alert('Selecciona una talla'); return; }
      cart.push({ product: key, size });
      saveCart();
      alert(`${productCatalog[key].name} (Talla ${size.toUpperCase()}) añadido al carrito.`);
      renderCart();
    }

    function renderCart(){
      const list = document.getElementById('cartList');
      list.innerHTML = '';
      if(cart.length === 0){
        list.innerHTML = '<li style="text-align:center;color:#aaa">El carrito está vacío</li>';
        document.getElementById('cartTotal').innerText = '';
        return;
      }
      let total = 0;
      cart.forEach((it, idx) => {
        const p = productCatalog[it.product];
        total += p.price;
        const li = document.createElement('li');
        li.className = 'cart-item';
        li.innerHTML = `
          <div>
            <div style="font-weight:700">${p.name}</div>
            <div class="meta">Talla ${it.size.toUpperCase()} — S/ ${p.price.toFixed(2)}</div>
          </div>
          <div>
            <button class="remove-btn" onclick="removeFromCart(${idx})">Eliminar</button>
          </div>
        `;
        list.appendChild(li);
      });
      document.getElementById('cartTotal').innerText = `Total: S/ ${total.toFixed(2)}`;
    }

    function removeFromCart(idx){
      cart.splice(idx,1);
      saveCart();
      renderCart();
    }

    /* ====== Comprar ====== */
    function buyNow(key){
      const select = document.getElementById(`${key}-size`);
      const size = select.value;
      if(!size){ alert('Selecciona una talla'); return; }
      const link = productCatalog[key].links[size];
      if(link) window.open(link,'_blank');
    }

    function checkout(){
      if(cart.length === 0){ alert('El carrito está vacío.'); return; }
      const last = cart[cart.length-1];
      const link = productCatalog[last.product].links[last.size];
      if(link) window.open(link,'_blank');
    }

    /* ====== Modal Producto ====== */
    let modalProduct = null;
    function openModal(key){
      modalProduct = key;
      const p = productCatalog[key];
      document.getElementById('modalName').innerText = p.name;
      document.getElementById('modalPrice').innerText = `S/ ${p.price.toFixed(2)}`;
      const carousel = document.getElementById('modalCarousel');
      carousel.innerHTML = '';
      p.images.forEach((src,i)=>{
        const img = document.createElement('img');
        img.src = src; img.className = i===0?'active':''; carousel.appendChild(img);
      });
      carousel.innerHTML += `
        <button class="btn prev" onclick="moveSlide('modalCarousel',-1)">❮</button>
        <button class="btn next" onclick="moveSlide('modalCarousel',1)">❯</button>
      `;
      document.getElementById('modalSize').value = '';
      document.getElementById('productModal').style.display = 'flex';
    }
    function closeModal(){ document.getElementById('productModal').style.display = 'none'; modalProduct=null; }
    window.onclick = function(e){ if(e.target === document.getElementById('productModal')) closeModal(); }

    function modalAddToCart(){
      const size = document.getElementById('modalSize').value;
      if(!size){ alert('Selecciona una talla'); return; }
      cart.push({ product: modalProduct, size });
      saveCart(); renderCart();
      alert(`${productCatalog[modalProduct].name} (Talla ${size.toUpperCase()}) añadido al carrito.`);
      closeModal();
    }
    function modalBuyNow(){
      const size = document.getElementById('modalSize').value;
      if(!size){ alert('Selecciona una talla'); return; }
      const link = productCatalog[modalProduct].links[size];
      if(link) window.open(link,'_blank');
      closeModal();
    }
  </script>
</body>
</html>
